(()=>{"use strict";function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.taskList=document.querySelector(".task-list"),this.cardPlacesArr=Array.from(document.getElementsByClassName("card-place")),this.draggedItem=null,this.selectedItem=null,this.selectedItemParent=null,this.rect=null,this.startX=0,this.startY=0,this.run()}var a,r,d;return a=t,(r=[{key:"run",value:function(){var e=this,t=document.createElement("div");t.classList.add("area"),document.addEventListener("mousedown",(function(a){if(!a.target.classList.contains("delete-card")&&(e.selectedItem=a.target.closest(".card"),e.selectedItem)){e.selectedItemParent=e.selectedItem.parentElement,e.rect=e.selectedItem.getBoundingClientRect(),e.width=e.selectedItem.clientWidth,e.height=e.selectedItem.clientHeight,e.startX=a.clientX,e.startY=a.clientY;var r=window,d=r.scrollX,c=r.scrollY;t.style.height="".concat(e.height,"px"),e.draggedItem=e.selectedItem.cloneNode(!0),e.draggedItem.classList.add("card-dragger"),e.draggedItem.style.width="".concat(e.width,"px"),e.draggedItem.style.height="".concat(e.height,"px"),e.draggedItem.style.left="".concat(e.rect.left+d,"px"),e.draggedItem.style.top="".concat(e.rect.top+c,"px"),e.taskList.appendChild(e.draggedItem),document.body.style.cursor="grabbing"}})),document.addEventListener("mousemove",(function(a){if(e.selectedItem){a.preventDefault();var r=window,d=r.scrollX,c=r.scrollY,n=e.rect.left+d+a.clientX-e.startX,s=e.rect.top+c+a.clientY-e.startY;if(e.draggedItem.style.top="".concat(s,"px"),e.draggedItem.style.left="".concat(n,"px"),e.selectedItem.remove(),a.target.classList.contains("card-place")&&!a.target.firstElementChild&&a.target.append(t),a.target.classList.contains("card")||a.target.closest(".card")){var i=a.target.classList.contains("card")?a.target:a.target.closest(".card"),o=i.getBoundingClientRect().height,l=i.getBoundingClientRect().top,u=a.clientY;u<l+o/2?i.insertAdjacentElement("beforebegin",t):u>l+o/2&&i.insertAdjacentElement("afterend",t)}}})),this.cardPlacesArr.forEach((function(e){e.addEventListener("mouseleave",(function(e){e.target.querySelector(".area")&&e.target.querySelector(".area").remove()}))})),document.addEventListener("mouseup",(function(t){if(e.selectedItem){var a=t.clientX,r=t.clientY,d=document.elementFromPoint(a,r);d.classList.contains("area")?d.closest(".card-place").replaceChild(e.selectedItem,d):d.classList.contains("area")||e.selectedItemParent.insertAdjacentElement("afterbegin",e.selectedItem),e.selectedItem=null,e.draggedItem.remove(),e.draggedItem=null,document.body.style.cursor="auto"}}))}}])&&e(a.prototype,r),d&&e(a,d),Object.defineProperty(a,"prototype",{writable:!1}),t}();function a(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.load(),this.DnD=t,this.taskList=document.querySelector(".task-list"),this.todo=this.taskList.querySelector('[data-card-place="todo"]'),this.inProgress=this.taskList.querySelector('[data-card-place="in-progress"]'),this.done=this.taskList.querySelector('[data-card-place="done"]'),this.addAnotherCard=Array.from(document.getElementsByClassName("footer-text")),this.footers=Array.from(document.getElementsByClassName("footer")),this.img=null,this.saveObject={},this.run()}var r,d,c;return r=e,(d=[{key:"run",value:function(){var e=this;this.save(),new t,this.taskList.addEventListener("mouseover",(function(t){if(t.target.classList.contains("card")||t.target.closest(".card")){var a=t.target.classList.contains("card")?t.target:t.target.closest(".card");a.querySelector(".delete-card").classList.remove("hidden"),a.addEventListener("mouseout",(function(){a.querySelector(".delete-card").classList.add("hidden")})),a.querySelector(".delete-card").addEventListener("click",(function(t){e.deleteCard(t)}))}})),this.footers.forEach((function(t){t.append(e.createAddCardBox())})),this.addAnotherCard.forEach((function(e){e.addEventListener("click",(function(e){e.target.closest(".task-list__column").querySelector(".add-card-box").classList.remove("hidden"),e.target.classList.add("hidden")}))}))}},{key:"createAddCardBox",value:function(){var e=this,t=document.createElement("div");t.classList.add("add-card-box"),t.classList.add("hidden"),t.innerHTML='\n            <div class="add-card-box__image-box hidden"></div>\n            <div class="add-card-box__textarea-box">\n                <textarea class="add-card-box__textarea"  maxlength="100" required placeholder="Enter text..."></textarea>\n            </div>\n            <div class="add-card-box__control">\n                <div class="add-card__and__file-btn">\n                    <button class="add-card-btn">Add</button>\n                    <div class="add-file-box">\n                        <input class="add-file-box__input" type="file">\n                    </div>\n                </div>\n                <div class="add-card__cancel"></div>\n            </div>';var a=t.querySelector(".add-card-btn"),r=t.querySelector(".add-file-box__input"),d=t.querySelector(".add-card__cancel");return a.addEventListener("click",(function(t){e.addCard(t)})),r.addEventListener("change",(function(t){e.addImage(t)})),d.addEventListener("click",(function(t){e.cancelAddCard(t)})),t}},{key:"addImage",value:function(e){var t=e.target.files[0];this.img=document.createElement("img"),this.img.src=URL.createObjectURL(t),this.img.classList.add("card-image")}},{key:"cancelAddCard",value:function(e){this.img&&(URL.revokeObjectURL(this.img.src),this.img=null),e.target.closest(".add-card-box__control").querySelector(".add-file-box__input").value="",e.target.closest(".add-card-box").querySelector(".add-card-box__textarea").value="",e.target.closest(".add-card-box").classList.add("hidden"),e.target.closest(".footer").firstElementChild.classList.remove("hidden")}},{key:"addCard",value:function(e){var t=document.createElement("div");t.classList.add("card");var a=e.target.closest(".add-card-box").querySelector(".add-card-box__textarea");t.innerHTML='\n        <div class="card-image-box"></div>\n        <div class="card-text-box">\n            <span class="card-text">'.concat(a.value,'</span>\n        </div>\n        <div class="card-footer">\n            <div class="delete-card hidden"></div>\n        </div>'),a.value="",this.img&&(t.querySelector(".card-image-box").append(this.img),this.img=null,e.target.closest(".add-card__and__file-btn").querySelector(".add-file-box__input").value=""),e.target.closest(".task-list__column").querySelector(".card-place").append(t),e.target.closest(".add-card-box").classList.add("hidden"),e.target.closest(".footer").firstElementChild.classList.remove("hidden"),URL.revokeObjectURL(this.img)}},{key:"eventsForCards",value:function(e){var t=this;e.addEventListener("mouseover",(function(){e.querySelector(".delete-card").classList.remove("hidden")})),e.addEventListener("mouseout",(function(){e.querySelector(".delete-card").classList.add("hidden")})),e.querySelector(".delete-card").addEventListener("click",(function(e){t.deleteCard(e)}))}},{key:"deleteCard",value:function(e){e.target.closest(".card").remove(),e.target.removeEventListener("click",this.deleteCard)}},{key:"save",value:function(){var e=this;window.addEventListener("beforeunload",(function(){e.saveObject.todo=e.todo.outerHTML,e.saveObject.inProgress=e.inProgress.outerHTML,e.saveObject.done=e.done.outerHTML,localStorage.myCards=JSON.stringify(e.saveObject)}))}},{key:"load",value:function(){if(void 0!==localStorage.myCards){var e=JSON.parse(localStorage.myCards);document.querySelector('[data-card-place="todo"]').outerHTML=e.todo,document.querySelector('[data-card-place="in-progress"]').outerHTML=e.inProgress,document.querySelector('[data-card-place="done"]').outerHTML=e.done}}}])&&a(r.prototype,d),c&&a(r,c),Object.defineProperty(r,"prototype",{writable:!1}),e}())})();